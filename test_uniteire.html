<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Tests Unitaires - le système de gestion RH</title>
</head>
<body>
  <h1>Résultats des Tests Unitaires :</h1>
  <pre id="test-results"></pre>
  <input type="text" id="ajout-nom">
  <input type="text" id="ajout-poste">
  <button onclick="ajouterEmployeManuel()">Ajouter</button>
  <ul id="liste-employes" style="display:none;"></ul>
  <!-- Inclure le code de l'application -->
  <script src="app.js"></script>

  <script>
    // Fonction d'assertion simple
    function assertEquals(actual, expected, testName) {
      const results = document.getElementById('test-results');
      if (actual === expected) {
        results.textContent += `✔️ ${testName} : Réussi\n`;
      } else {
        results.textContent += `❌ ${testName} : Échoué\n   Attendu : ${expected}\n   Obtenu : ${actual}\n`;
      }
    }

    function testAjouterEmployeManuel(){

    const nom = document.getElementById('ajout-nom').value;
    const poste = document.getElementById('ajout-poste').value;
    const id = employes.length > 0 ? employes[employes.length - 1].id + 1 : 1;
    if (nom && poste) {
        ajouterEmploye(id, nom, poste);
        afficherEmployes();
    }
      let result = ajouterEmploye(4,'Lili','Développeur');
      assertEquals(result, {id: 4, nom: "Lili", poste: "Développeur"}, 'employe ajouter');

      let listeEmployes = document.getElementById('liste-employes');
      let lastEmploye= listeEmployes.lastElementChild;
      assertEquals(astEmploye.textContent.contains({id: 4, nom: "Lili", poste: "Développeur"}), true, 'Vérifier que employe est ajoutée');
    }



    function testAjouterEmploye() {

      let result = ajouterEmploye(4,'Lili','Développeur');
      assertEquals(result, {id: 4, nom: "Lili", poste: "Développeur"}, 'employe ajouter');
      employeLast=result.forEach(e => {e.id === 4 && e.nom === 'Lili' && e.poste === 'Développeur'
});
      assertEquals(employeLast, true, 'Vérifier que employe est ajoutée');
    }

    // Tests pour toggleTask
    function testToggleTask() {
      // Ajouter une tâche pour le test
      addTask('Faire les courses');
      let taskList = document.getElementById('task-list');
      let taskItem = taskList.lastElementChild;

      // Simuler un clic pour marquer comme terminée
      taskItem.dispatchEvent(new Event('click'));
      assertEquals(taskItem.classList.contains('completed'), true, 'Test toggleTask pour marquer comme terminée');

      // Simuler un autre clic pour démarquer
      taskItem.dispatchEvent(new Event('click'));
      assertEquals(taskItem.classList.contains('completed'), false, 'Test toggleTask pour démarquer');
    }

    // Tests pour deleteTask
    function testDeleteTask() {
      // Ajouter une tâche pour le test
      addTask('Faire les courses');
      let taskList = document.getElementById('task-list');
      let taskItem = taskList.lastElementChild;

      // Nombre de tâches avant suppression
      let n = taskList.children.length;

      // Simuler un clic sur le bouton de suppression
      taskItem.querySelector('.delete-button').dispatchEvent(new Event('click'));
      let n2 = taskList.children.length;
      // Vérifier que la tâche a été supprimée
      assertEquals(n-1, n2, 'Vérifier que la tâche a été supprimée');
    }

    // Exécution des tests
    function runTests() {
      testAddTask();
      testToggleTask();
      testDeleteTask();
    }

    runTests();
  </script>
</body>
</html>
